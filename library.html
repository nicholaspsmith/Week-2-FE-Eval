<html>
<head>
  <title>Week 2 Frontend Project</title>
  <style type="text/css">
    #templates { display: block; }
    small { position: fixed; bottom: 4px; right: 4px; }
    #library .book {
      background: #ccc;
      width: 200px;
      float: left;
      padding: 1px 20px;
    }
    #library .book h3 {
      font-style: italic;
    }
    #library .book h5 {
      font-weight: normal;
    }
    .book{
      float: left;
      margin-right: 5px;
      margin-top: 5px;
    }
    #inputs {
      display: block;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<h1>THE LIBRARY</h1>

<div id="inputs">
  <input type="text" id="text1" placeholder="Title"/>
  <input type="text" id="text2" placeholder="Author"/>
</div>
    <button type="button" id="submit">Turn In</button>

<div id="library"></div>

  <div id="templates">
    <script class="book" type="text/template">
      <div class="book">
        <p><%=title%> by <%=author%> is <%=status%></p>
        <button type="button" id="checkout">Check out</button>
      </div>
    </script>
  </div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
<script type="text/javascript">


//make a string with which to create template
var templateHtml = $('#templates .book').html();

// Make a template with that string
var template = _.template(templateHtml);

var books = [];

var renderLibrary = function () {
console.log("XXXXXXXX");
}

var addBook = function (book) {
  book.status = 'available';
  this.books.push(book);
}

var getBook = function (title) {
  for (var i = 0; i < books.length; i++){
    if (books[i].title === title){
      return books[i];
    }
  }
}

var checkoutBook = function (title) {
  for (var i = 0; i < books.length; i++){
    if (books[i].title === title){
      books[i].status = 'checkedOut';
      return books[i];
    }
  }
  return null;
}



var Library = function () {
  this.templateHtml = templateHtml;
  this.template = template;
  this.addBook = addBook;
  this.getBook = getBook;
  this.books = books;
  this.checkoutBook = checkoutBook;

  this.render = function () {
    $('#library').empty();
    for (var i = 0; i < books.length; i++){
      var templ = this.template(books[i]);
      $('#library').append(templ);
    }
  }
}

$('#submit').on('click', function(){
  var add_title = $('#text1').val();
  var add_author = $('#text2').val();

  books.push({title: add_title, author: add_author, status: 'available'});

  lib.render();
});

$('#checkout').on('click', function(){
  console.log('this');
});

var lib = new Library();
console.log('New library:', lib);

lib.addBook({
  title: 'Test Title 1',
  author: 'Author 1'
});
console.log('# of books should be 1:', lib.books.length);

lib.addBook({
  title: 'Test Title 2',
  author: 'Author 2'
});
console.log('# of books should be 2:', lib.books.length);

var book = lib.getBook('Test Title 1');
console.log('The book should exist:', book);
console.log('Book status should be available:', book.status);

// This should render all the library's books to the web page
lib.render();

console.log("The following should return an object: ", lib.checkoutBook('Test Title 2'));



console.log("The following should return null: ",lib.checkoutBook('asdfasdf'));

    
</script>



<small>It's back.</small>

</body>
</html>
